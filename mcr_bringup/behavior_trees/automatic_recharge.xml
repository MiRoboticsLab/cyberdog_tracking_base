<?xml version="1.0"?>
<root main_tree_to_execute="MainTree">
    <!-- ////////// -->
    <BehaviorTree ID="MainTree">
        <Control ID="RecoveryNode" name="TargetTracking" number_of_retries="5">
            <SequenceStar>
                <Action ID="ChangeGait" gait="7" next_action_start="{next_start}"/>
                <SequenceStar>
                <Control ID="PipelineSequence" name="NavigateWithReplanning">
                    <Decorator ID="RateController" hz="5.0">
                        <Decorator ID="ChargerUpdater"  phase="0"  output_exception_code="{exception}" output_goals="{updated_goals}">
                            <Action ID="ComputePathSplinePoses" path="{path}" server_timeout="1000" planner_id="SplinePlannerL" poses="{updated_goals}"/>
                        </Decorator>
                    </Decorator>
                    <Action ID="FollowPath" controller_id="TrackingTargetL" server_timeout="1000"  goal_checker_id="general_goal_checker" path="{path}" progress_checker_id="fake_progress_checker"/>
                </Control>
                <Control ID="PipelineSequence" name="NavigateWithReplanning">
                    <Decorator ID="RateController" hz="5.0">
                        <Decorator ID="ChargerUpdater" phase="1" output_exception_code="{exception}" output_goals="{updated_goals}">
                            <Action ID="ComputePathSplinePoses" path="{path}"  server_timeout="1000" planner_id="SplinePlannerL" poses="{updated_goals}"/>
                        </Decorator>
                    </Decorator>
                    <Action ID="FollowPath" controller_id="TrackingTargetL" server_timeout="1000"  goal_checker_id="general_goal_checkerL" path="{path}" progress_checker_id="fake_progress_checker"/>
                </Control>
                </SequenceStar>
                <Action ID="ChangeGait" gait="2" next_action_start="{next_start}"/>
                <Condition ID="IsBatteryInCharge"/>
            </SequenceStar>
            <ReactiveFallback name="RecoveryActions">
                <Decorator ID="ExceptionVerify" exception_code="{exception}" expected_code="10000">
                    <Action ID="SpinAndSearch" search_dist="1.57"/>
                </Decorator>
                <Decorator ID="ExceptionVerify" exception_code="{exception}" expected_code="3000">
                    <Action ID="ClearEntireCostmap" name="ClearEntireGlobalCostmap" service_name="global_costmap/clear_entirely_global_costmap"/>
                </Decorator>
                <ForceSuccess>
                    <Decorator ID="ExceptionVerify" exception_code="{exception}" expected_code="4000">
                        <Action ID="ClearEntireCostmap" name="ClearEntireLocalCostmap" service_name="local_costmap/clear_entirely_local_costmap"/>
                    </Decorator>
                </ForceSuccess>
            </ReactiveFallback>
        </Control>
    </BehaviorTree>
</root>

